---
layout: solution
codename: numbase
---

## Επεξήγηση εκφώνησης

Ο αριθμός $$M$$ μπορεί να γραφτεί σε μία βάση $$K$$ με όλα τα $$n$$ ψηφία του ίδια, αν υπάρχει $$x < K$$ ώστε

$$x + xK + xK^2 + ... + xK^{(n-1)} = M$$

Κάνουμε τις εξής παρατηρήσεις που βοηθάνε σε όλες τις λύσεις (ή την ανάλυση αυτών):

**Παρατήρηση 1:** Το μέγιστο $$n$$ γίνεται όταν η βάση είναι ελάχιστη, δηλαδή $$K=2$$. Άρα το μέγιστο $$n$$ είναι της τάξης $$\log_2(M)$$.

**Παρατήρηση 2:** Όλοι οι αριθμοί $$M$$ στη βάση $$K = M+1$$ χρησιμοποιούν μόνο ένα στοιχείο, άρα ικανοποιούν την συνθήκη.

## Λύση 1 (30%)

Δοκιμάζουμε όλες τις πιθανές βάσεις $$K < M$$ και δοκιμάζουμε όλα τα πιθανά ψηφία $$x < K$$ αν ικανοποιούν την παραπάνω εξίσωση.

Ο αλγόριθμος χρειάζεται $$\mathcal{O}(M^2 \log M)$$ χρόνο και σταθερή μνήμη.

{% include code.md solution_name='numbase_brute_force.cc' %}

## Λύση 2 (50%)

Δοκιμάζουμε όλες τις πιθανές βάσεις $$K < M$$ και ελέγχουμε αν η αναπαράσταση έχει όλα τα ψηφία ίδια. 

Η αναπαράσταση ενός αριθμού στην βάση $$K$$ μπορεί να υπολογιστεί διαιρώντας με την βάση $$K$$ και κρατώντας το υπόλοιπο με το $$K$$ σε κάθε βήμα. Για παράδειγμα, για την βάση $$K = 10$$ μπορούμε να βρούμε την αναπαράσταση του $$M = 562$$ ως εξής:
 1. $$M = 562$$, $$M_0 = M \% 10 = 2$$,
 1. $$M' = M / 10 = 56$$, $$M_1 = M' \% 10 = 6$$,
 1. $$M'' = M' / 10 = 5$$, $$M_2 = M'' \% 10 = 5$$.
Επομένως, παίρνουμε τα ψηφία $$2, 6, 5$$ που είναι τα ψηφία του $$M$$ σε αντίστροφη σειρά.

Ο αλγόριθμος χρειάζεται $$\mathcal{O}(M \log M)$$ χρόνο και σταθερή μνήμη.

{% include code.md solution_name='numbase_50_first.cc' start=5 end=26 %}

## Λύση 3 (50%)

Σταθεροποιούμε τα $$x$$ και $$n$$, και ορίζουμε την συνάρτηση
$$s(K) = x + xK + xK^2 + ... + xK^{(n-1)}$$.
Για μεγαλύτερο $$K$$ παίρνουμε μεγαλύτερες τιμές $$s(K)$$. Επομένως κάνουμε δυαδική αναζήτηση ψάχνοντας το $$K$$ ώστε $$s(K) = M$$. 

Ο αλγόριθμος αυτός χρειάζεται να διατρέξει όλα τα $$\mathcal{O}(\log_2(M))$$ δυνατά $$n$$ και τα $$\mathcal{O}(M)$$ δυνατά $$x$$, και να τρέξει μία δυαδική αναζήτηση (δηλαδή $$\mathcal{O}(\log_2(M))$$ βήματα) με χρόνο $$\mathcal{O}(\log_2(M))$$ το καθένα. Επομένως, συνολικά ο αλγόριθμος χρειάζεται $$\mathcal{O}(M (\log M)^3)$$ χρόνο και σταθερή μνήμη.

**Σημείωση:** Ο λόγος που χρησιμοποιούμε το γραμμικό άθροισμα αντί τον τύπο για το άθροισμα γεωμετρικής προόδου είναι ότι ο υπολογισμός του μπορεί να κάνει εύκολα overflow.

{% include code.md solution_name='numbase_50_second.cc' start=6 end=57 %}


## Λύση 4 (100%)

Κάνουμε την εξής παρατήρηση:

**Παρατήρηση:** Παραγοντοποιούμε την αρχική σχέση, $$x(1 + K + K^2 + ... + K^{(n-1)}) = M$$. Επομένως $$x \mid M$$.

Άρα χρειάζεται να ελέγξουμε μόνο για τους διαιρέτες του $$M$$ ως πιθανά ψηφία.

**Θεώρημα:** Ένας φυσικός αριθμός $$M$$ δεν έχει πάνω από $$2\sqrt{M}$$ διαιρέτες.

*Απόδειξη:* Έστω $$x | M$$, τότε $$M = xy$$ για κάποιον άλλο διαιρέτη $$y$$. Θα δείξουμε ότι αν $$x \neq \sqrt{M}$$, τότε ένας διαιρέτης είναι μεγαλύτερος από $$\sqrt{M}$$ και ένας μικρότερος. 
Αν $$x > \sqrt{M}$$ και $$y > \sqrt{M}$$, τότε $$M = xy > \sqrt{M}^2 = M$$ (άτοπο). Αντίστοιχα για την περίπτωση που $$x < \sqrt{M}$$ και $$y < \sqrt{M}$$. Άρα ένας διαιρέτης είναι μεγαλύτερος από $$\sqrt{M}$$ και ένας μικρότερος.
Αυτό σημαίνει ότι κάθε διαιρέτης $$d_1 > \sqrt{M}$$ του $$M$$ αντιστοιχεί σε έναν διαιρέτη $$d_2 < \sqrt{M}$$ του $$M$$. Συνεπώς υπάρχουν το πολύ $$2 \sqrt{M} - 1$$ διαιρέτες (μετρώντας τον $$\sqrt{M}$$ το πολύ μία φορά).

Με το παραπάνω θεώρημα μπορούμε θα περιορίσουμε τους αριθμούς $$x$$ που θα ελέγξουμε και να επιταχύνουμε τη Λύση 3. Ο αλγόριθμος χρειάζεται $$\mathcal{O}(\sqrt{M} (\log M)^3)$$ χρόνο και σταθερή μνήμη.

{% include code.md solution_name='numbase_correct.cc' start=42 end=55 %}
